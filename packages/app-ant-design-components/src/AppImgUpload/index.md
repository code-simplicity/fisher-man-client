---
toc: content
title: AppImgUpload组件
order: 5
group:
  title: 通用系统级别
demo:
  cols: 2
---

# AppImgUpload 图片上传组件

<code src="./demos/basic.tsx">限制只能上传单张图片</code>
<code src="./demos/open-img-crop.tsx">不开启图片上传之前的剪切</code>

<code src="./demos/manual-upload.tsx">手动上传图片的表单</code>

## API 参数

| 参数         | 说明                               | 类型                             | 默认值           |
| ------------ | ---------------------------------- | -------------------------------- | ---------------- |
| openImgCrop  | 是否开启图片剪切                   | `ReactNode`                      | `()=> ReactNode` |
| imgCropProps | 图片剪切的配置，具体配置在下面查看 | `Omit<ImgCropProps, 'children'>` | `确认`           |

### UploadProps

| 参数                  | 说明                                                                                                                                                                                                                                                                                                   | 类型                                                                                                                                                                                                                                                                               | 默认值                                                                                                                                   | 版本            |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- | --------------- |
| accept                | 接受上传的文件类型, 详见 [input accept Attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#accept)                                                                                                                                                                         | string                                                                                                                                                                                                                                                                             | -                                                                                                                                        |                 |
| action                | 上传的地址                                                                                                                                                                                                                                                                                             | string \| (file) => Promise&lt;string>                                                                                                                                                                                                                                             | -                                                                                                                                        |                 |
| beforeUpload          | 上传文件之前的钩子，参数为上传的文件，若返回 `false` 则停止上传。支持返回一个 Promise 对象，Promise 对象 reject 时则停止上传，resolve 时开始上传（ resolve 传入 `File` 或 `Blob` 对象则上传 resolve 传入对象）；也可以返回 `Upload.LIST_IGNORE`，此时列表中将不展示此文件。 **注意：IE9 不支持该方法** | (file, fileList) => boolean \| Promise&lt;File> \| `Upload.LIST_IGNORE`                                                                                                                                                                                                            | -                                                                                                                                        |                 |
| customRequest         | 通过覆盖默认的上传行为，可以自定义自己的上传实现                                                                                                                                                                                                                                                       | function                                                                                                                                                                                                                                                                           | -                                                                                                                                        |                 |
| data                  | 上传所需额外参数或返回上传额外参数的方法                                                                                                                                                                                                                                                               | object\|(file) => object \| Promise&lt;object>                                                                                                                                                                                                                                     | -                                                                                                                                        |                 |
| defaultFileList       | 默认已经上传的文件列表                                                                                                                                                                                                                                                                                 | object\[]                                                                                                                                                                                                                                                                          | -                                                                                                                                        |                 |
| directory             | 支持上传文件夹（[caniuse](https://caniuse.com/#feat=input-file-directory)）                                                                                                                                                                                                                            | boolean                                                                                                                                                                                                                                                                            | false                                                                                                                                    |                 |
| disabled              | 是否禁用                                                                                                                                                                                                                                                                                               | boolean                                                                                                                                                                                                                                                                            | false                                                                                                                                    |                 |
| fileList              | 已经上传的文件列表（受控），使用此参数时，如果遇到 `onChange` 只调用一次的问题，请参考 [#2423](https://github.com/ant-design/ant-design/issues/2423)                                                                                                                                                   | [UploadFile](#uploadfile)\[]                                                                                                                                                                                                                                                       | -                                                                                                                                        |                 |
| headers               | 设置上传的请求头部，IE10 以上有效                                                                                                                                                                                                                                                                      | object                                                                                                                                                                                                                                                                             | -                                                                                                                                        |                 |
| iconRender            | 自定义显示 icon                                                                                                                                                                                                                                                                                        | (file: UploadFile, listType?: UploadListType) => ReactNode                                                                                                                                                                                                                         | -                                                                                                                                        |                 |
| isImageUrl            | 自定义缩略图是否使用 &lt;img /> 标签进行显示                                                                                                                                                                                                                                                           | (file: UploadFile) => boolean                                                                                                                                                                                                                                                      | [(内部实现)](https://github.com/ant-design/ant-design/blob/4ad5830eecfb87471cd8ac588c5d992862b70770/components/upload/utils.tsx#L47-L68) |                 |
| itemRender            | 自定义上传列表项                                                                                                                                                                                                                                                                                       | (originNode: ReactElement, file: UploadFile, fileList: object\[], actions: { download: function, preview: function, remove: function }) => React.ReactNode                                                                                                                         | -                                                                                                                                        | 4.16.0          |
| listType              | 上传列表的内建样式，支持三种基本样式 `text`, `picture` 和 `picture-card`                                                                                                                                                                                                                               | string                                                                                                                                                                                                                                                                             | `text`                                                                                                                                   |                 |
| maxCount              | 限制上传数量。当为 1 时，始终用最新上传的文件代替当前文件                                                                                                                                                                                                                                              | number                                                                                                                                                                                                                                                                             | -                                                                                                                                        | 4.10.0          |
| method                | 上传请求的 http method                                                                                                                                                                                                                                                                                 | string                                                                                                                                                                                                                                                                             | `post`                                                                                                                                   |                 |
| multiple              | 是否支持多选文件，`ie10+` 支持。开启后按住 ctrl 可选择多个文件                                                                                                                                                                                                                                         | boolean                                                                                                                                                                                                                                                                            | false                                                                                                                                    |                 |
| name                  | 发到后台的文件参数名                                                                                                                                                                                                                                                                                   | string                                                                                                                                                                                                                                                                             | `file`                                                                                                                                   |                 |
| openFileDialogOnClick | 点击打开文件对话框                                                                                                                                                                                                                                                                                     | boolean                                                                                                                                                                                                                                                                            | true                                                                                                                                     |                 |
| previewFile           | 自定义文件预览逻辑                                                                                                                                                                                                                                                                                     | (file: File \| Blob) => Promise&lt;dataURL: string>                                                                                                                                                                                                                                | -                                                                                                                                        |                 |
| progress              | 自定义进度条样式                                                                                                                                                                                                                                                                                       | [ProgressProps](/components/progress-cn#api)（仅支持 `type="line"`）                                                                                                                                                                                                               | { strokeWidth: 2, showInfo: false }                                                                                                      | 4.3.0           |
| showUploadList        | 是否展示文件列表, 可设为一个对象，用于单独设定 `showPreviewIcon`, `showRemoveIcon`, `showDownloadIcon`, `removeIcon` 和 `downloadIcon`                                                                                                                                                                 | boolean \| { showPreviewIcon?: boolean, showRemoveIcon?: boolean, showDownloadIcon?: boolean, previewIcon?: ReactNode \| (file: UploadFile) => ReactNode, removeIcon?: ReactNode \| (file: UploadFile) => ReactNode, downloadIcon?: ReactNode \| (file: UploadFile) => ReactNode } | true                                                                                                                                     | function: 4.7.0 |
| withCredentials       | 上传请求时是否携带 cookie                                                                                                                                                                                                                                                                              | boolean                                                                                                                                                                                                                                                                            | false                                                                                                                                    |                 |
| onChange              | 上传文件改变时的回调，详见 [onChange](#onchange)                                                                                                                                                                                                                                                       | function                                                                                                                                                                                                                                                                           | -                                                                                                                                        |                 |
| onDrop                | 当文件被拖入上传区域时执行的回调功能                                                                                                                                                                                                                                                                   | (event: React.DragEvent) => void                                                                                                                                                                                                                                                   | -                                                                                                                                        | 4.16.0          |
| onDownload            | 点击下载文件时的回调，如果没有指定，则默认跳转到文件 url 对应的标签页                                                                                                                                                                                                                                  | function(file): void                                                                                                                                                                                                                                                               | (跳转新标签页)                                                                                                                           |                 |
| onPreview             | 点击文件链接或预览图标时的回调                                                                                                                                                                                                                                                                         | function(file)                                                                                                                                                                                                                                                                     | -                                                                                                                                        |                 |
| onRemove              | 点击移除文件时的回调，返回值为 false 时不移除。支持返回一个 Promise 对象，Promise 对象 resolve(false) 或 reject 时不移除                                                                                                                                                                               | function(file): boolean \| Promise                                                                                                                                                                                                                                                 | -                                                                                                                                        |                 |

### ImgCropProps

该属性可以去[antd-img-crop](https://github.com/nanxiaobei/antd-img-crop)寻找，下面也列举出来了，不过可能官网会更新，以官网的为准。

| 属性                    | 类型                 | 默认         | 说明                                                   |
| ----------------------- | -------------------- | ------------ | ------------------------------------------------------ |
| aspect                  | `number`             | `1 / 1`      | 裁切区域宽高比，`width / height`                       |
| shape                   | `string`             | `'rect'`     | 裁切区域形状，`'rect'` 或 `'round'`                    |
| grid                    | `boolean`            | `false`      | 显示裁切区域网格（九宫格）                             |
| quality                 | `number`             | `0.4`        | 图片质量，`0 ~ 1`                                      |
| fillColor               | `string`             | `'white'`    | 裁切图像小于画布时的填充颜色                           |
| zoom                    | `boolean`            | `true`       | 启用图片缩放                                           |
| rotate                  | `boolean`            | `false`      | 启用图片旋转                                           |
| minZoom                 | `number`             | `1`          | 最小缩放倍数                                           |
| maxZoom                 | `number`             | `3`          | 最大缩放倍数                                           |
| modalTitle              | `string`             | `'编辑图片'` | 弹窗标题                                               |
| modalWidth              | `number` \| `string` | `520`        | 弹窗宽度，`px` 的数值或百分比                          |
| modalOk                 | `string`             | `'确定'`     | 弹窗确定按钮文字                                       |
| modalCancel             | `string`             | `'取消'`     | 弹窗取消按钮文字                                       |
| modalMaskTransitionName | `string`             | `'fade'`     | 弹窗遮罩过渡效果, 设为 `'none'` 可禁用默认过渡效果     |
| modalClassName          | `string`             | `''`         | 为 Modal 容器提供您自己的类名                          |
| modalTransitionName     | `string`             | `'fade'`     | 弹窗过渡效果, 设为 `'none'` 可禁用默认过渡效果         |
| onModalOK               | `function`           | -            | 点击弹窗确定回调                                       |
| onModalCancel           | `function`           | -            | 点击弹窗遮罩层、右上角叉、取消的回调                   |
| beforeCrop              | `function`           | -            | 弹窗打开前调用，若返回 `false`，弹框将不会打开         |
| onUploadFail            | `function`           | -            | 上传失败时的回调                                       |
| cropperProps            | `object`             | -            | [react-easy-crop] 的 props（\* [已有 props] 无法重写） |
